---
layout: post
title:  "java源码分析之HashMap"
date:   2016-07-04 1:05:00
catalog:  true
tags:
    - 数据结构
    - HashMap
       

---

## 概述


<div id="article_content" class="article_content">

<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
在Java集合类中最常用的除了ArrayList外，就是HashMap了。本文尽自己所能，尽量详细的解释HashMap的源码。一山还有一山高，有不足之处请之处，定感谢指定并及时修正。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp; 在看HashMap源码之前先复习一下数据结构。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;Java最基本的数据结构有数组和链表。数组的特点是空间连续（大小固定）、寻址迅速，但是插入和删除时需要移动元素，所以查询快，增加删除慢。链表恰好相反，可动态增加或减少空间以适应新增和删除元素，但查找时只能顺着一个个节点查找，所以增加删除快，查找慢。有没有一种结构综合了数组和链表的优点呢？当然有，那就是<span style="margin:0px; padding:0px">哈希表</span>（虽说是综合优点，但实际上查找肯定没有数组快，插入删除没有链表快，一种折中的方式吧）。一般采用拉链法实现哈希表。哈希表？拉链法？可能一下想不起来，不过放张图就了然了。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
<img src="http://pic002.cnblogs.com/images/2012/471426/2012122409394770.png" alt="" style="margin:0px; padding:0px; border:0px"></p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;<span style="margin:0px; padding:0px; font-size:13px"><span style="margin:0px; padding:0px">（图片google来的，好多都用了文章用了这张图了，不知道出处了就没申明作者了）</span></span></p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;学计算机的肯定学过这玩意儿，也不需要解释，都懂的。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;铺垫了这么多，又是数组又是链表，还有哈希表，拉链法，该入正题了，我们什么时候用到了这些内容，具体它是怎么实现的？</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;其实我们一直在用（别告诉我你没用过HashMap什么的），可能你一直没去深究，没看到它如何实现的，所以一直没感受到。这里主要分析HashMap的源码，就不再多扯其他的了。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp; HashMap继承自AbstractMap，实现了Map接口（这些内容可以参考<a href="http://www.cnblogs.com/hzmark/archive/2012/12/17/CollectionBase.html" target="_blank" style="margin:0px; padding:0px; color:rgb(68,68,68)">《Java集合类》</a>）。来看类的定义。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">class</span> HashMap&lt;K,V&gt; <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> AbstractMap&lt;K,V&gt; <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">implements</span> Map&lt;K,V&gt;, Cloneable, Serializable</pre>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;Map接口定义了所有Map子类必须实现的方法。Map接口中还定义了一个内部接口Entry（为什么要弄成内部接口？改天还要学习学习）。Entry将在后面有详细的介绍。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;AbstractMap也实现了Map接口，并且提供了两个实现Entry的内部类：SimpleEntry和SimpleImmutableEntry。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;定义了接口，接口中又有内部接口，然后有搞了个抽象类实现接口，抽象类里面又搞了两个内部类实现接口的内部接口，有没有点绕，为什么搞成这样呢？先不管了，先看HashMap吧。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;HashMap中定义的属性（应该都能看明白，不过还是解释一下）：</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">/**</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 2</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">     * 默认的初始容量，必须是2的幂。
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 3</span>      <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">*/</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 4</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">static</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> DEFAULT_INITIAL_CAPACITY = 16<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 5</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">/**</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 6</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">     * 最大容量（必须是2的幂且小于2的30次方，传入容量过大将被这个值替换）
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 7</span>      <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">*/</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 8</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">static</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> MAXIMUM_CAPACITY = 1 &lt;&lt; 30<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 9</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">/**</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">10</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">     * 默认装载因子，这个后面会做解释
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">11</span>      <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">*/</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">12</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">static</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">float</span> DEFAULT_LOAD_FACTOR = 0.75f<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">13</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">/**</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">14</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">     * 存储数据的Entry数组，长度是2的幂。看到数组的内容了，接着看数组中存的内容就明白为什么博文开头先复习数据结构了
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">15</span>      <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">*/</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">16</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">transient</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> Entry[] table;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">17</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">/**</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">18</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">     * map中保存的键值对的数量
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">19</span>      <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">*/</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">20</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">transient</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> size;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">21</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">/**</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">22</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">     * 需要调整大小的极限值（容量*装载因子）
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">23</span>      <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">*/</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">24</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> threshold;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">25</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">/**</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">26</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">     *装载因子
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">27</span>      <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">*/</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">28</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">float</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> loadFactor;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">29</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">/**</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">30</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">     * map结构被改变的次数
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">31</span>      <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">*/</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">32</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">transient</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">volatile</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> modCount;</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;接着是HashMap的构造方法。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">/**</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">
     *使用默认的容量及装载因子构造一个空的HashMap
     </span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">*/</span>
    <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> HashMap() {
        </span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">this</span>.loadFactor =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> DEFAULT_LOAD_FACTOR;
        threshold </span>= (<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span>)(DEFAULT_INITIAL_CAPACITY * DEFAULT_LOAD_FACTOR);<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">计算下次需要调整大小的极限值</span>
        table = <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">new</span> Entry[DEFAULT_INITIAL_CAPACITY];<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">根据默认容量（16）初始化table</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        init();
    }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">/**</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">
     * 根据给定的初始容量的装载因子创建一个空的HashMap
     * 初始容量小于0或装载因子小于等于0将报异常 
     </span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">*/</span>
    <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> HashMap(<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> initialCapacity, <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">float</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> loadFactor) {
        </span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (initialCapacity &lt; 0<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">)
            </span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">throw</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">new</span> IllegalArgumentException("Illegal initial capacity: " +<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">
                                               initialCapacity);
        </span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">调整最大容量</span>
            initialCapacity =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> MAXIMUM_CAPACITY;
        </span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (loadFactor &lt;= 0 ||<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> Float.isNaN(loadFactor))
            </span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">throw</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">new</span> IllegalArgumentException("Illegal load factor: " +<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">
                                               loadFactor);
        </span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> capacity = 1<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
        </span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">设置capacity为大于initialCapacity且是2的幂的最小值</span>
        <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">while</span> (capacity &lt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> initialCapacity)
            capacity </span>&lt;&lt;= 1<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
        </span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">this</span>.loadFactor =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> loadFactor;
        threshold </span>= (<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span>)(capacity *<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> loadFactor);
        table </span>= <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">new</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> Entry[capacity];
        init();
    }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">/**</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">
     *根据指定容量创建一个空的HashMap
     </span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">*/</span>
    <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> HashMap(<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> initialCapacity) {
        </span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">调用上面的构造方法，容量为指定的容量，装载因子是默认值</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">    }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">/**</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">
     *通过传入的map创建一个HashMap，容量为默认容量（16）和(map.zise()/DEFAULT_LOAD_FACTORY)+1的较大者，装载因子为默认值
     </span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">*/</span>
    <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> HashMap(Map&lt;? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> K, ? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> V&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> m) {
        </span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">this</span>(Math.max((<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span>) (m.size() / DEFAULT_LOAD_FACTOR) + 1<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">,
                      DEFAULT_INITIAL_CAPACITY), DEFAULT_LOAD_FACTOR);
        putAllForCreate(m);
    }</span></pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;上面的构造方法中调用到了init()方法，最后一个方法还调用了putAllForCreate(Map&lt;? extends K, ? extends V&gt; m)。init方法是一个空方法，里面没有任何内容。putAllForCreate看方法名就是创建的时候将传入的map全部放入新创建的对象中。该方法中还涉及到其他方法，将在后面介绍。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp; 先看初始化table时均使用了Entry，这是HashMap的一个内部类，实现了Map接口的内部接口Entry。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;下面给出Map.Entry接口及HashMap.Entry类的内容。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;Map.Entry接口定义的方法</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">1</span> K getKey();<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">获取Key</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">2</span> V getValue();<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">获取Value</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">3</span> V setValue();<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">设置Value，至于具体返回什么要看具体实现</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">4</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">boolean</span> equals(Object o);<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">定义equals方法用于判断两个Entry是否相同</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">5</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> hashCode();<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">定义获取hashCode的方法</span></pre>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;HashMap.Entry类的具体实现</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">static</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">class</span> Entry&lt;K,V&gt; <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">implements</span> Map.Entry&lt;K,V&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 2</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> K key;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 3</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        V value;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 4</span>         Entry&lt;K,V&gt; next;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">对下一个节点的引用（看到链表的内容，结合定义的Entry数组，是不是想到了哈希表的拉链法实现？！）</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 5</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> hash;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">哈希值</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 6</span> 
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 7</span>         Entry(<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> h, K k, V v, Entry&lt;K,V&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> n) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 8</span>             value =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> v;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 9</span>             next =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> n;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">10</span>             key =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> k;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">11</span>             hash =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> h;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">12</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">13</span> 
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">14</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> K getKey() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">15</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> key;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">16</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">17</span> 
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">18</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> V getValue() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">19</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> value;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">20</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">21</span> 
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">22</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> V setValue(V newValue) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">23</span>         V oldValue =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> value;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">24</span>             value =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> newValue;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">25</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> oldValue;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">返回的是之前的Value</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">26</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">27</span> 
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">28</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">boolean</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> equals(Object o) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">29</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (!(o <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">instanceof</span> Map.Entry))<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">先判断类型是否一致</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">30</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">false</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">31</span>             Map.Entry e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> (Map.Entry)o;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">32</span>             Object k1 =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> getKey();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">33</span>             Object k2 =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.getKey();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">34</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> Key相等且Value相等则两个Entry相等</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">35</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (k1 == k2 || (k1 != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span> &amp;&amp;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> k1.equals(k2))) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">36</span>                 Object v1 =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> getValue();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">37</span>                 Object v2 =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.getValue();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">38</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (v1 == v2 || (v1 != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span> &amp;&amp;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> v1.equals(v2)))
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">39</span>                     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">true</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">40</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">            }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">41</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">false</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">42</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">43</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> hashCode是Key的hashCode和Value的hashCode的异或的结果</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">44</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> hashCode() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">45</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> (key==<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span>   ? 0 : key.hashCode()) ^
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">46</span>                    (value==<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span> ? 0<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> : value.hashCode());
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">47</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">48</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> 重写toString方法，是输出更清晰</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">49</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> String toString() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">50</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> getKey() + "=" +<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> getValue();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">51</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">52</span> 
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">53</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">/**</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">54</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">         *当调用put(k,v)方法存入键值对时，如果k已经存在，则该方法被调用（为什么没有内容？）
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">55</span>          <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">*/</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">56</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">void</span> recordAccess(HashMap&lt;K,V&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> m) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">57</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">58</span> 
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">59</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">/**</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">60</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">         * 当Entry被从HashMap中移除时被调用（为什么没有内容？）
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">61</span>          <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">*/</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">62</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">void</span> recordRemoval(HashMap&lt;K,V&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> m) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">63</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">64</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;看完属性和构造方法，接着看HashMap中的其他方法，一个个分析，从最常用的put和get说起吧。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;<span style="margin:0px; padding:0px">put()</span></p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> V put(K key, V value) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 2</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (key == <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 3</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> putForNullKey(value);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 4</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> hash =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> hash(key.hashCode());
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 5</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> i =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> indexFor(hash, table.length);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 6</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">for</span> (Entry&lt;K,V&gt; e = table[i]; e != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span>; e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.next) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 7</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">            Object k;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 8</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (e.hash == hash &amp;&amp; ((k = e.key) == key ||<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> key.equals(k))) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 9</span>                 V oldValue =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.value;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">10</span>                 e.value =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> value;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">11</span>                 e.recordAccess(<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">this</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">12</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> oldValue;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">13</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">            }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">14</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">15</span> 
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">16</span>         modCount++<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">17</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        addEntry(hash, key, value, i);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">18</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">19</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp; 当存入的key是null的时候将调用putForNUllKey方法，暂时将这段逻辑放一边，看key不为null的情况。先调用了hash(int h)方法获取了一个hash值。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">static</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> hash(<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> h) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">2</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> This function ensures that hashCodes that differ only by
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">3</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> constant multiples at each bit position have a bounded
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">4</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> number of collisions (approximately 8 at default load factor).</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">5</span>         h ^= (h &gt;&gt;&gt; 20) ^ (h &gt;&gt;&gt; 12<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">6</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> h ^ (h &gt;&gt;&gt; 7) ^ (h &gt;&gt;&gt; 4<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">7</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;这个方法的主要作用是防止质量较差的哈希函数带来过多的冲突（碰撞）问题。Java中int值占4个字节，即32位。根据这32位值进行移位、异或运算得到一个值。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">static</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> indexFor(<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> h, <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> length) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">2</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> h &amp; (length-1<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">3</span>     }</pre>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;indexFor返回hash值和table数组长度减1的与运算结果。<span style="margin:0px; padding:0px">为什么使用的是length-1？应为这样可以保证结果的最大值是length-1，不会产生数组越界问题。</span></p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;获取索引位置之后做了什么？探测table[i]所在的链表，所发现key值与传入的key值相同的对象，则替换并返回oldValue。若找不到，则通过addEntry(hash,key,value,i)添加新的对象。来看addEntry(hash,key,value,i)方法。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">void</span> addEntry(<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> hash, K key, V value, <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> bucketIndex) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">2</span>     Entry&lt;K,V&gt; e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> table[bucketIndex];
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">3</span>         table[bucketIndex] = <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">new</span> Entry&lt;K,V&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">(hash, key, value, e);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">4</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (size++ &gt;=<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> threshold)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">5</span>             resize(2 *<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> table.length);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">6</span>     }</pre>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;这就是在一个链表头部插入一个节点的过程。获取table[i]的对象e，将table[i]的对象修改为新增对象，让新增对象的next指向e。之后判断size是否到达了需要扩充table数组容量的界限并让size自增1，如果达到了则调用resize(int capacity)方法将数组容量拓展为原来的两倍。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">void</span> resize(<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> newCapacity) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 2</span>         Entry[] oldTable =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> table;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 3</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> oldCapacity =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> oldTable.length;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 4</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> 这个if块表明，如果容量已经到达允许的最大值，即MAXIMUN_CAPACITY，则不再拓展容量，而将装载拓展的界限值设为计算机允许的最大值。
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 5</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> 不会再触发resize方法，而是不断的向map中添加内容，即table数组中的链表可以不断变长，但数组长度不再改变</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 6</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (oldCapacity ==<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> MAXIMUM_CAPACITY) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 7</span>             threshold =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> Integer.MAX_VALUE;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 8</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 9</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">10</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> 创建新数组，容量为指定的容量</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">11</span>         Entry[] newTable = <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">new</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> Entry[newCapacity];
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">12</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        transfer(newTable);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">13</span>         table =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> newTable;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">14</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> 设置下一次需要调整数组大小的界限</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">15</span>         threshold = (<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span>)(newCapacity *<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> loadFactor);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">16</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;结合上面给出的注释，调整数组容量的内容仅剩下将原table中的内容复制到newTable中并将newTable返回给原table。即上面代码中的“transfer(newTable);table = newTable;”。来看transfer(Entry[] newTable)方法。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">void</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> transfer(Entry[] newTable) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 2</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> 保留原数组的引用到src中，</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 3</span>         Entry[] src =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> table;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 4</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> 新容量使新数组的长度</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 5</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> newCapacity =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> newTable.length;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 6</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> 遍历原数组</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 7</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">for</span> (<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> j = 0; j &lt; src.length; j++<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 8</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> 获取元素e</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 9</span>             Entry&lt;K,V&gt; e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> src[j];
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">10</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (e != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">11</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> 将原数组中的元素置为null</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">12</span>                 src[j] = <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">13</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> 遍历原数组中j位置指向的链表</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">14</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">do</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">15</span>                     Entry&lt;K,V&gt; next =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.next;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">16</span>                     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> 根据新的容量计算e在新数组中的位置</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">17</span>                     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> i =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> indexFor(e.hash, newCapacity);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">18</span>                     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> 将e插入到newTable[i]指向的链表的头部</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">19</span>                     e.next =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> newTable[i];
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">20</span>                     newTable[i] =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">21</span>                     e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> next;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">22</span>                 } <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">while</span> (e != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">23</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">            }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">24</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">25</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp; 从上面的代码可以看出，HashMap之所以不能保持元素的顺序有以下几点原因：第一，插入元素的时候对元素进行哈希处理，不同元素分配到table的不同位置；第二，容量拓展的时候又进行了hash处理；第三，复制原表内容的时候链表被倒置。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp; 一个put方法带出了这么多内容，接着看看putAll吧。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">void</span> putAll(Map&lt;? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> K, ? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> V&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> m) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 2</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> numKeysToBeAdded =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> m.size();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 3</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (numKeysToBeAdded == 0<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 4</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 5</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)">//</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,0)"> 为什么判断条件是numKeysToBeAdded，不是(numKeysToBeAdded+table.length)&gt;threshold???</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 6</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (numKeysToBeAdded &gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> threshold) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 7</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> targetCapacity = (<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span>)(numKeysToBeAdded / loadFactor + 1<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 8</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (targetCapacity &gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> MAXIMUM_CAPACITY)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 9</span>                 targetCapacity =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> MAXIMUM_CAPACITY;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">10</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> newCapacity =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> table.length;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">11</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">while</span> (newCapacity &lt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> targetCapacity)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">12</span>                 newCapacity &lt;&lt;= 1<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">13</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (newCapacity &gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> table.length)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">14</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">                resize(newCapacity);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">15</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">16</span> 
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">17</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">for</span> (Iterator&lt;? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> Map.Entry&lt;? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> K, ? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> V&gt;&gt; i =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> m.entrySet().iterator(); i.hasNext(); ) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">18</span>             Map.Entry&lt;? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> K, ? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> V&gt; e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> i.next();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">19</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">            put(e.getKey(), e.getValue());
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">20</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">21</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;先回答上面的问题：为什么判断条件是numKeysToBeAdded，不是(numKeysToBeAdded+table.length)&gt;threshold???</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;这是一种保守的做法，明显地，我们应该在(numKeysToBeAdded+table.length)&gt;threshold的时候去拓展容量，但是考虑到将被添加的元素可能会有Key与原本存在的Key相同的情况，所以采用保守的做法，避免拓展到过大的容量。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;接着是遍历m中的内容，然后调用put方法将元素添加到table数组中。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;遍历的时候涉及到了entrySet方法，这个方法定义在Map接口中，HashMap中也有实现，后面会解释HashMap的这个方法，其它Map的实现暂不解释。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;下面介绍在put方法中被调用到的putForNullKey方法。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">private</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> V putForNullKey(V value) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 2</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">for</span> (Entry&lt;K,V&gt; e = table[0]; e != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span>; e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.next) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 3</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (e.key == <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 4</span>                 V oldValue =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.value;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 5</span>                 e.value =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> value;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 6</span>                 e.recordAccess(<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">this</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 7</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> oldValue;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 8</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">            }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 9</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">10</span>         modCount++<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">11</span>         addEntry(0, <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span>, value, 0<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">12</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">13</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;这是一个私有方法，在put方法中被调用。它首先遍历table数组，如果找到key为null的元素，则替换元素值并返回oldValue；否则通过addEntry方法添加元素，之后返回null。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;还记得上面构造方法中调用到的putAllForCreate吗？一口气将put操作的方法看完吧。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">private</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">void</span> putAllForCreate(Map&lt;? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> K, ? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> V&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> m) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">2</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">for</span> (Iterator&lt;? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> Map.Entry&lt;? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> K, ? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> V&gt;&gt; i =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> m.entrySet().iterator(); i.hasNext(); ) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">3</span>             Map.Entry&lt;? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> K, ? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> V&gt; e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> i.next();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">4</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">            putForCreate(e.getKey(), e.getValue());
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">5</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">6</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp; 先将遍历的过程放在一边，因为它同样涉及到了entrySet()方法。剩下的代码很简单，只是调用putForCreate方法逐个元素加入。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">private</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">void</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> putForCreate(K key, V value) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 2</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> hash = (key == <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span>) ? 0<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> : hash(key.hashCode());
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 3</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> i =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> indexFor(hash, table.length);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 4</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">for</span> (Entry&lt;K,V&gt; e = table[i]; e != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span>; e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.next) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 5</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">            Object k;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 6</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (e.hash == hash &amp;&amp;
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 7</span>                 ((k = e.key) == key || (key != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span> &amp;&amp;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> key.equals(k)))) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 8</span>                 e.value =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> value;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 9</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">10</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">            }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">11</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">12</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        createEntry(hash, key, value, i);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">13</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;该方法先计算需要添加的元素的hash值和在table数组中的索引i。接着遍历table[i]的链表，若有元素的key值与传入key值相等，则替换value，结束方法。若不存在key值相同的元素，则调用createEntry创建并添加元素。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">void</span> createEntry(<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> hash, K key, V value, <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> bucketIndex) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">2</span>     Entry&lt;K,V&gt; e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> table[bucketIndex];
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">3</span>         table[bucketIndex] = <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">new</span> Entry&lt;K,V&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">(hash, key, value, e);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">4</span>         size++<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">5</span>     }</pre>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;这个方法的内容就不解释了，上面都解释过。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;至此所有put相关操作都解释完毕了。put之外，另一个常用的操作就是get，下面就来看get方法。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> V get(Object key) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 2</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (key == <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 3</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> getForNullKey();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 4</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> hash =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> hash(key.hashCode());
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 5</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">for</span> (Entry&lt;K,V&gt; e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> table[indexFor(hash, table.length)];
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 6</span>              e != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 7</span>              e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.next) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 8</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">            Object k;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 9</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (e.hash == hash &amp;&amp; ((k = e.key) == key ||<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> key.equals(k)))
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">10</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.value;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">11</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">12</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">13</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;该方法分为key为null和不为null两块。先看不为null的情况。先获取key的hash值，之后通过hash值及table.length获取key对应的table数组的索引，遍历索引的链表，所找到key相同的元素，则返回元素的value，否者返回null。不为null的情况调用了getForNullKey()方法。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">private</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> V getForNullKey() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">2</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">for</span> (Entry&lt;K,V&gt; e = table[0]; e != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span>; e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.next) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">3</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (e.key == <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">4</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.value;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">5</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">6</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">7</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp; 这是一个私有方法，只在get中被调用。该方法判断table[0]中的链表是否包含key为null的元素，包含则返回value，不包含则返回null。为什么是遍历table[0]的链表？因为key为null的时候获得的hash值都是0。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;添加（put）和获取（get）都结束了，接着看如何判断一个元素是否存在。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;HashMap没有提供判断元素是否存在的方法，只提供了判断Key是否存在及Value是否存在的方法，分别是containsKey(Object key)、containsValue(Object value)。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;containsKey(Object key)方法很简单，只是判断getEntry(key)的结果是否为null，是则返回false，否返回true。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">boolean</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> containsKey(Object key) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 2</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> getEntry(key) != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 3</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">    }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 4</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span> Entry&lt;K,V&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> getEntry(Object key) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 5</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> hash = (key == <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span>) ? 0<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> : hash(key.hashCode());
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 6</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">for</span> (Entry&lt;K,V&gt; e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> table[indexFor(hash, table.length)];
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 7</span>              e != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 8</span>              e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.next) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 9</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">            Object k;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">10</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (e.hash == hash &amp;&amp;
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">11</span>                 ((k = e.key) == key || (key != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span> &amp;&amp;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> key.equals(k))))
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">12</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">13</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">14</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">15</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;getEntry(Object key)也没什么内容，只是根据key对应的hash值计算在table数组中的索引位置，然后遍历该链表判断是否存在相同的key值。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">boolean</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> containsValue(Object value) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 2</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (value == <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 3</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> containsNullValue();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 4</span> 
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 5</span>     Entry[] tab =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> table;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 6</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">for</span> (<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> i = 0; i &lt; tab.length ; i++<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 7</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">for</span> (Entry e = tab[i] ; e != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span> ; e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.next)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 8</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> (value.equals(e.value))
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 9</span>                     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">true</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">10</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">false</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">11</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">    }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">12</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">private</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">boolean</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> containsNullValue() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">13</span>     Entry[] tab =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> table;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">14</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">for</span> (<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> i = 0; i &lt; tab.length ; i++<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">15</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">for</span> (Entry e = tab[i] ; e != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span> ; e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.next)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">16</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (e.value == <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">17</span>                     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">true</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">18</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">false</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">19</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;判断一个value是否存在比判断key是否存在还要简单，就是遍历所有元素判断是否有相等的值。这里分为两种情况处理，value为null何不为null的情况，但内容差不多，只是判断相等的方式不同。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;<span style="margin:0px; padding:0px">这个判断是否存在必须遍历所有元素，是一个双重循环的过程，因此是比较耗时的操作。</span></p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;接着看HashMap中“删除”相关的操作，有remove(Object key)和clear()两个方法。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;<span style="margin:0px; padding:0px">remove(Object key)</span></p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> V remove(Object key) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">2</span>         Entry&lt;K,V&gt; e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> removeEntryForKey(key);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">3</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> (e == <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span> ? <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> : e.value);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">4</span>     }</pre>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp; 看这个方法，removeEntryKey(key)的返回结果应该是被移除的元素，如果不存在这个元素则返回为null。remove方法根据removeEntryKey返回的结果e是否为null返回null或e.value。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;<span style="margin:0px; padding:0px">removeEntryForKey(Object key)</span></p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span> Entry&lt;K,V&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> removeEntryForKey(Object key) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 2</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> hash = (key == <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span>) ? 0<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> : hash(key.hashCode());
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 3</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> i =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> indexFor(hash, table.length);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 4</span>         Entry&lt;K,V&gt; prev =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> table[i];
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 5</span>         Entry&lt;K,V&gt; e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> prev;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 6</span> 
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 7</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">while</span> (e != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 8</span>             Entry&lt;K,V&gt; next =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e.next;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 9</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">            Object k;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">10</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (e.hash == hash &amp;&amp;
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">11</span>                 ((k = e.key) == key || (key != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span> &amp;&amp;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> key.equals(k)))) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">12</span>                 modCount++<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">13</span>                 size--<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">14</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (prev ==<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">15</span>                     table[i] =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> next;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">16</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">else</span>
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">17</span>                     prev.next =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> next;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">18</span>                 e.recordRemoval(<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">this</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">19</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">20</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">            }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">21</span>             prev =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">22</span>             e =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> next;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">23</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">24</span> 
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">25</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> e;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">26</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp; 上面的这个过程就是先找到table数组中对应的索引，接着就类似于一般的链表的删除操作，而且是单向链表删除节点，很简单。在C语言中就是修改指针，这个例子中就是将要删除节点的前一节点的next指向删除被删除节点的next即可。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;<span style="margin:0px; padding:0px">clear()</span></p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">void</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> clear() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">2</span>         modCount++<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">3</span>         Entry[] tab =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> table;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">4</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">for</span> (<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span> i = 0; i &lt; tab.length; i++<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">)
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">5</span>             tab[i] = <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">6</span>         size = 0<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">7</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp; clear()方法删除HashMap中所有的元素，这里就不用一个个删除节点了，而是直接将table数组内容都置空，这样所有的链表都已经无法访问，Java的垃圾回收机制会去处理这些链表。table数组置空后修改size为0。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;<span style="margin:0px; padding:0px">这里为什么不直接操作table而是通过tab呢？希望有知道的大侠指点一二。</span></p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp; 主要方法看的差不多了，接着看一个上面提到了好几次但是都搁在一边没有分析的方法：entrySet()。&nbsp;</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;<span style="margin:0px; padding:0px">entrySet()</span></p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> Set&lt;Map.Entry&lt;K,V&gt;&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> entrySet() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">2</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> entrySet0();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">3</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">    }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">4</span> 
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">5</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">private</span> Set&lt;Map.Entry&lt;K,V&gt;&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> entrySet0() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">6</span>         Set&lt;Map.Entry&lt;K,V&gt;&gt; es =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> entrySet;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">7</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> es != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span> ? es : (entrySet = <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">new</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> EntrySet());
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">8</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
<span style="margin:0px; padding:0px">&nbsp; &nbsp; 为什么会有这样的方法，只是调用了一下entrySet0，而且entrySet0的名称看着就很奇怪。再看entrySet0方法中为什么不直接return entrySet!=null?entrySet:(entrySet = new EntrySet)呢？</span></p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;上面的疑问还没解开，但是先看entrySet这个属性吧，在文章开头的属性定义中并没有给出这个属性，下面先看一下它的定义：</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">private</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">transient</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet = <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span>;</pre>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp; 它是一个内容为Map.Entry&lt;K,V&gt;的Set。<span style="margin:0px; padding:0px; color:rgb(255,0,0)">看看在哪些地方往里面添加了元素。&nbsp;</span></p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;为什么上面的那句话我要把它标成红色？因为这是一个陷阱，在看代码的时候我就陷进去了。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp; 仔细看EntrySet这个类。</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">private</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">class</span> EntrySet <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> AbstractSet&lt;Map.Entry&lt;K,V&gt;&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 2</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> Iterator&lt;Map.Entry&lt;K,V&gt;&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> iterator() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 3</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> newEntryIterator();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 4</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 5</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">boolean</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> contains(Object o) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 6</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">if</span> (!(o <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">instanceof</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> Map.Entry))
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 7</span>                 <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">false</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 8</span>             Map.Entry&lt;K,V&gt; e = (Map.Entry&lt;K,V&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">) o;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 9</span>             Entry&lt;K,V&gt; candidate =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> getEntry(e.getKey());
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">10</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> candidate != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span> &amp;&amp;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> candidate.equals(e);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">11</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">12</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">boolean</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> remove(Object o) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">13</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> removeMapping(o) != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">14</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">15</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> size() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">16</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> size;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">17</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">18</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">void</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> clear() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">19</span>             HashMap.<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">this</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">.clear();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">20</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">21</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;看到了什么？这个类根本就没属性，它只是个代理。因为它内部类，可以访问外部类的内容，debug的时候能看到的属性都是继承或者外部类的属性，输出的时候其实也是调用到了父类的toString方法将HashMap中的内容输出了。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;<span style="margin:0px; padding:0px">keySet()</span></p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> Set&lt;K&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> keySet() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">2</span>         Set&lt;K&gt; ks =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> keySet;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">3</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> (ks != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span> ? ks : (keySet = <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">new</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> KeySet()));
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">4</span>     }</pre>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp;</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp; 是不是和entrySet0()方法很像！</p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">private</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">class</span> KeySet <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> AbstractSet&lt;K&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 2</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> Iterator&lt;K&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> iterator() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 3</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> newKeyIterator();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 4</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 5</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> size() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 6</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> size;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 7</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 8</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">boolean</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> contains(Object o) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 9</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> containsKey(o);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">10</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">11</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">boolean</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> remove(Object o) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">12</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> HashMap.<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">this</span>.removeEntryForKey(o) != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">13</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">14</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">void</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> clear() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">15</span>             HashMap.<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">this</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">.clear();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">16</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">17</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;同样是个代理类，contains、remove、clear方法都是调用的HashMap的方法。&nbsp;</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp;</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
<span style="margin:0px; padding:0px; color:rgb(255,0,0)"><span style="margin:0px; padding:0px">&nbsp; &nbsp;&nbsp;<span style="margin:0px; padding:0px; color:rgb(0,0,0)">values()</span></span></span></p>
<div class="cnblogs_code" style="margin:5px 0px; padding:5px; background-color:rgb(245,245,245); font-family:'Courier New'; border:1px solid rgb(204,204,204); overflow:auto; color:rgb(68,68,68); line-height:18px">
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; white-space:pre-wrap; word-wrap:break-word; font-family:'Courier New'"><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 1</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> Collection&lt;V&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> values() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 2</span>         Collection&lt;V&gt; vs =<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> values;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 3</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span> (vs != <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">null</span> ? vs : (values = <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">new</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> Values()));
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 4</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">    }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 5</span> 
<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 6</span>     <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">private</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">final</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">class</span> Values <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">extends</span> AbstractCollection&lt;V&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 7</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> Iterator&lt;V&gt;<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> iterator() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 8</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> newValueIterator();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)"> 9</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">10</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">int</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> size() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">11</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> size;
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">12</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">13</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">boolean</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> contains(Object o) {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">14</span>             <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">return</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> containsValue(o);
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">15</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">16</span>         <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">public</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">void</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)"> clear() {
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">17</span>             HashMap.<span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,255)">this</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">.clear();
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">18</span> <span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,0,0)">        }
</span><span style="margin:0px; padding:0px; line-height:1.5; color:rgb(0,128,128)">19</span>     }</pre>
<div class="cnblogs_code_toolbar" style="margin:5px 0px 0px; padding:0px"><span class="cnblogs_code_copy" style="margin:0px; padding:0px 5px 0px 0px; line-height:1.5"><a href="http://www.cnblogs.com/hzmark/archive/2012/12/24/HashMap.html" title="复制代码" style="margin:0px; padding:0px; color:rgb(68,68,68); border:none!important"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="margin:0px; padding:0px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
&nbsp; &nbsp;&nbsp;values()方法也一样是代理。只是Values类继承自AbstractCollention类，而不是AbstractSet。</p>
<p style="margin:10px auto; padding-top:0px; padding-bottom:0px; color:rgb(68,68,68); font-family:tahoma,arial,sans-serif; line-height:18px">
<span style="margin:0px; padding:0px; color:rgb(255,0,0)"><span style="margin:0px; padding:0px">&nbsp; &nbsp; 还有一个重要的内容没有进行说明，那就是迭代器。HashMap中的entrySet()、keySet()、values()等方法都使用到了迭代器Iterator的知识。其他集合类也有使用到迭代器</span></span></p>
   
</div>


  
## 参考

[http://blog.csdn.net/jzhf2012/article/details/8540670](http://blog.csdn.net/jzhf2012/article/details/8540670)